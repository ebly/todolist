# 云数据库权限设置

## 数据库集合权限配置

需要在微信开发者工具的云开发控制台中设置 `todos` 集合的权限：

### 1. 打开云开发控制台
- 点击微信开发者工具顶部的"云开发"按钮

### 2. 设置数据库权限
- 进入"数据库" → "todos" 集合
- 点击"权限设置"
- 选择"仅创建者可读写" 或自定义安全规则

### 3. 推荐的安全规则
```json
{
  "read": "doc._openid == auth.openid",
  "write": "doc._openid == auth.openid"
}
```

这样每个用户只能读写自己创建的待办数据。

## 云函数部署

### 部署 getOpenId 云函数
1. 在微信开发者工具中，右键点击 `cloudfunctions/getOpenId` 文件夹
2. 选择"创建并部署：云端安装依赖"
3. 等待部署完成

### 验证部署
1. 进入云开发控制台 → "云函数"
2. 确认 `getOpenId` 函数已列出且状态正常

## 数据隔离说明

- 每个用户的待办数据通过 `_openid` 字段隔离
- 云数据库会自动为每条记录添加 `_openid` 字段（创建者的openid）
- 查询时根据当前用户的 openid 过滤
- 用户只能看到自己的待办数据
